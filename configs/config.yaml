server:
  http_port: 8080
  read_timeout: 30s
  write_timeout: 30s

ingest:
  max_batch_size: 1000
  max_payload_size: 10485760  # 10MB
  cef:
    # SECURITY WARNING: Plain UDP provides NO encryption
    # Only enable for trusted internal networks or testing
    udp:
      enabled: false  # DISABLED by default - use DTLS for secure UDP
      address: ":5514"
      buffer_size: 16777216  # 16MB
      workers: 8
      max_message_size: 65535
    # DTLS provides encrypted UDP transport - RECOMMENDED for production
    dtls:
      enabled: false  # Enable after configuring certificates
      address: ":5516"
      cert_file: "certs/server.crt"
      key_file: "certs/server.key"
      # ca_file: "certs/ca.crt"  # Optional: for client certificate verification
      require_client_cert: false
      workers: 8
      max_message_size: 65535
      connection_timeout: 30s
      idle_timeout: 5m
    tcp:
      enabled: true
      address: ":5515"
      tls_enabled: false  # Enable TLS for production security
      tls_cert_file: "certs/server.crt"
      tls_key_file: "certs/server.key"
      max_connections: 1000
      idle_timeout: 5m
      max_line_length: 65535
    parser:
      strict_mode: false
      max_extensions: 100
    normalizer:
      default_tenant_id: "default"

queue:
  size: 100000
  overflow_policy: reject

validation:
  max_event_age: 168h     # 7 days
  max_future: 5m
  strict_mode: false      # Disabled by default - enable for production

auth:
  api_key_header: X-API-Key
  enabled: false
  # api_keys:
  #   - sk_test_development

logging:
  level: info
  format: json

# Storage configuration
# Set storage.enabled to true and configure ClickHouse to persist events
storage:
  enabled: false  # Set to true when ClickHouse is available
  clickhouse:
    hosts:
      - "localhost:9000"
    database: siem
    username: default
    password: ""
    max_open_conns: 10
    max_idle_conns: 5
    conn_max_lifetime: 1h
    tls_enabled: false
    dial_timeout: 10s
  batch_writer:
    batch_size: 1000
    flush_interval: 5s
    max_retries: 3
    retry_delay: 1s

# Consumer configuration
consumer:
  workers: 4
  poll_interval: 10ms
  shutdown_wait: 30s

# NatLangChain integration
# Enable to ingest events from a NatLangChain blockchain node
natlangchain:
  enabled: false  # Set to true to enable NatLangChain integration
  client:
    base_url: "http://localhost:5000"
    api_key: ""  # Set your NatLangChain API key
    chain_id: "main"
    timeout: 30s
    max_retries: 3
    retry_backoff: 1s
  ingester:
    poll_interval: 30s
    block_batch_size: 100
    entry_batch_size: 500
    # Feature toggles - enable/disable specific event types
    ingest_entries: true
    ingest_blocks: true
    ingest_disputes: true
    ingest_contracts: true
    ingest_negotiations: true
    ingest_validation: true
    ingest_semantic_drift: true
    # Minimum severity for semantic drift events (low, medium, high, critical)
    min_drift_severity: "low"
  normalizer:
    default_tenant_id: "default"
    source_host: "localhost"
    source_version: "1.0.0"

# Value Ledger integration
# Enable to ingest events from Value Ledger (value tracking with vector scores)
valueledger:
  enabled: false  # Set to true to enable Value Ledger integration
  client:
    base_url: "http://localhost:8100"
    api_key: ""  # Set your Value Ledger API key
    timeout: 30s
    max_retries: 3
    retry_backoff: 1s
  ingester:
    poll_interval: 30s
    batch_size: 100

# ILR-Module integration
# Enable to ingest events from ILR-Module (Immutable License Registry for dispute resolution)
ilrmodule:
  enabled: false  # Set to true to enable ILR-Module integration
  client:
    base_url: "http://localhost:8200"
    api_key: ""  # Set your ILR-Module API key
    timeout: 30s
    max_retries: 3
    retry_backoff: 1s
  ingester:
    poll_interval: 30s
    batch_size: 100

# Learning Contracts integration
# Enable to ingest events from Learning Contracts (consent management)
learningcontracts:
  enabled: false  # Set to true to enable Learning Contracts integration
  client:
    base_url: "http://localhost:8300"
    api_key: ""  # Set your Learning Contracts API key
    timeout: 30s
    max_retries: 3
    retry_backoff: 1s
  ingester:
    poll_interval: 30s
    batch_size: 100

# Mediator Node integration
# Enable to ingest events from Mediator Node (intent-aligned mediation)
mediatornode:
  enabled: false  # Set to true to enable Mediator Node integration
  client:
    base_url: "http://localhost:8400"
    api_key: ""  # Set your Mediator Node API key
    timeout: 30s
    max_retries: 3
    retry_backoff: 1s
  ingester:
    poll_interval: 30s
    batch_size: 100

# Memory Vault integration
# Enable to ingest events from Memory Vault (secure memory storage)
memoryvault:
  enabled: false  # Set to true to enable Memory Vault integration
  client:
    base_url: "http://localhost:8500"
    api_key: ""  # Set your Memory Vault API key
    timeout: 30s
    max_retries: 3
    retry_backoff: 1s
  ingester:
    poll_interval: 30s
    batch_size: 100

# Synth Mind integration
# Enable to ingest events from Synth Mind (Agent-OS psychological modules)
synthmind:
  enabled: false  # Set to true to enable Synth Mind integration
  client:
    base_url: "http://localhost:8600"
    api_key: ""  # Set your Synth Mind API key
    timeout: 30s
    max_retries: 3
    retry_backoff: 1s
  ingester:
    poll_interval: 30s
    batch_size: 100

# IntentLog integration
# Enable to ingest events from IntentLog (prose-based version control)
intentlog:
  enabled: false  # Set to true to enable IntentLog integration
  client:
    base_url: "http://localhost:8700"
    api_key: ""  # Set your IntentLog API key
    timeout: 30s
    max_retries: 3
    retry_backoff: 1s
  ingester:
    poll_interval: 30s
    batch_size: 100

# RRA-Module integration
# Enable to ingest events from RRA-Module (Revenant Repo Agent)
rramodule:
  enabled: false  # Set to true to enable RRA-Module integration
  client:
    base_url: "http://localhost:8800"
    api_key: ""  # Set your RRA-Module API key
    timeout: 30s
    max_retries: 3
    retry_backoff: 1s
  ingester:
    poll_interval: 30s
    batch_size: 100

# Boundary Daemon integration
# Enable to ingest security events from Boundary Daemon
# (session management, authentication, access control, threat detection, policy enforcement)
boundarydaemon:
  enabled: false  # Set to true to enable Boundary Daemon integration
  client:
    base_url: "http://localhost:9000"  # Boundary Daemon API endpoint
    api_key: ""  # Set your Boundary Daemon API key
    timeout: 30s
    max_retries: 3
    retry_backoff: 1s
  ingester:
    poll_interval: 30s
    session_batch_size: 500
    auth_batch_size: 500
    access_batch_size: 500
    threat_batch_size: 100
    policy_batch_size: 200
    audit_batch_size: 500
    # Event type toggles
    ingest_sessions: true
    ingest_auth: true
    ingest_access: true
    ingest_threats: true
    ingest_policies: true
    ingest_audit_logs: true
    verify_audit_logs: false  # Enable to verify cryptographic signatures (slower)
    min_threat_severity: "low"  # Filter threats by minimum severity (low, medium, high, critical)
  normalizer:
    default_tenant_id: "default"
    source_host: "localhost"
    source_version: "1.0.0"
