server:
  http_port: 8080
  read_timeout: 30s
  write_timeout: 30s

ingest:
  max_batch_size: 1000
  max_payload_size: 10485760  # 10MB
  cef:
    udp:
      enabled: true
      address: ":5514"
      buffer_size: 16777216  # 16MB
      workers: 8
      max_message_size: 65535
    tcp:
      enabled: true
      address: ":5515"
      tls_enabled: false
      # tls_cert_file: /etc/siem/certs/server.crt
      # tls_key_file: /etc/siem/certs/server.key
      max_connections: 1000
      idle_timeout: 5m
      max_line_length: 65535
    parser:
      strict_mode: false
      max_extensions: 100
    normalizer:
      default_tenant_id: "default"

queue:
  size: 100000
  overflow_policy: reject

validation:
  max_event_age: 168h     # 7 days
  max_future: 5m
  strict_mode: false      # Disabled by default - enable for production

auth:
  api_key_header: X-API-Key
  enabled: false
  # api_keys:
  #   - sk_test_development

logging:
  level: info
  format: json

# Storage configuration
# Set storage.enabled to true and configure ClickHouse to persist events
storage:
  enabled: false  # Set to true when ClickHouse is available
  clickhouse:
    hosts:
      - "localhost:9000"
    database: siem
    username: default
    password: ""
    max_open_conns: 10
    max_idle_conns: 5
    conn_max_lifetime: 1h
    tls_enabled: false
    dial_timeout: 10s
  batch_writer:
    batch_size: 1000
    flush_interval: 5s
    max_retries: 3
    retry_delay: 1s

# Consumer configuration
consumer:
  workers: 4
  poll_interval: 10ms
  shutdown_wait: 30s
