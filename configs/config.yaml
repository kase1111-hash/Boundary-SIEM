server:
  http_port: 8080
  read_timeout: 30s
  write_timeout: 30s

ingest:
  max_batch_size: 1000
  max_payload_size: 10485760  # 10MB
  cef:
    # SECURITY WARNING: Plain UDP provides NO encryption
    # Only enable for trusted internal networks or testing
    udp:
      enabled: false  # DISABLED by default - use DTLS for secure UDP
      address: ":5514"
      buffer_size: 16777216  # 16MB
      workers: 8
      max_message_size: 65535
    # DTLS provides encrypted UDP transport - RECOMMENDED for production
    dtls:
      enabled: false  # Enable after configuring certificates
      address: ":5516"
      cert_file: "certs/server.crt"
      key_file: "certs/server.key"
      # ca_file: "certs/ca.crt"  # Optional: for client certificate verification
      require_client_cert: false
      workers: 8
      max_message_size: 65535
      connection_timeout: 30s
      idle_timeout: 5m
    tcp:
      enabled: true
      address: ":5515"
      tls_enabled: false  # SECURITY WARNING: Set tls_enabled: true for production
      tls_cert_file: "certs/server.crt"
      tls_key_file: "certs/server.key"
      max_connections: 1000
      idle_timeout: 5m
      max_line_length: 65535
    parser:
      strict_mode: false
      max_extensions: 100
    normalizer:
      default_tenant_id: "default"

  # EVM JSON-RPC poller for blockchain event ingestion
  evm:
    enabled: false  # Enable to poll EVM-compatible blockchains
    poll_interval: 12s
    batch_size: 10
    start_block: "latest"
    chains:
      - name: ethereum
        chain_id: 1
        rpc_url: "http://localhost:8545"
        enabled: false
      # - name: polygon
      #   chain_id: 137
      #   rpc_url: "https://polygon-rpc.com"
      #   enabled: false

queue:
  size: 100000

validation:
  max_event_age: 168h     # 7 days
  max_future: 5m
  strict_mode: false      # Disabled by default - enable for production

auth:
  api_key_header: X-API-Key
  enabled: true  # SECURITY: Authentication is enabled by default
  # api_keys:
  #   - sk_test_development

logging:
  level: info
  format: json

# Storage configuration
# ClickHouse is used to persist and query events
storage:
  enabled: true  # Enabled by default - requires ClickHouse to be running
  clickhouse:
    hosts:
      - "localhost:9000"
    database: siem
    username: default
    password: ""  # SECURITY WARNING: Configure a strong password for production
    max_open_conns: 10
    max_idle_conns: 5
    conn_max_lifetime: 1h
    tls_enabled: false  # SECURITY WARNING: Enable TLS for production
    dial_timeout: 10s
  batch_writer:
    batch_size: 1000
    flush_interval: 5s
    max_retries: 3
    retry_delay: 1s
  retention:
    events_ttl: 2160h       # 90 days
    critical_ttl: 8760h     # 365 days
    quarantine_ttl: 720h    # 30 days
    alerts_ttl: 8760h       # 365 days

# Consumer configuration
consumer:
  workers: 4
  poll_interval: 10ms
  shutdown_wait: 30s

